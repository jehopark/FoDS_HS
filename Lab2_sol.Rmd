---
title: "Week 2 Exercises"
author:
date:
output: html_notebook
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(nycflights13)
```

## 5.2.4 Exercise

#### 1: Find all flights that

(1) Had an arrival delay of two or more hours
```{r}
filter(flights, arr_delay >= 120)
```

(2) Flew to Houston (IAH or HOU)
```{r}
filter(flights, dest == "IAH" | dest == "HOU")
```

(4) Departed in summer (July, August, and September)
```{r}
filter(flights, month %in% 7:9)
```

(5) Arrived more than two hours late, but didnâ€™t leave late
```{r}
filter(flights, arr_delay > 120, dep_delay <= 0)
```

(6) Were delayed by at least an hour, but made up over 30 minutes in flight
```{r}
fliter(flights, dep_delay >= 60, dep_delay - arr_delay > 30)
```

(7) Departed between midnight and 6am (inclusive)
```{r}
filter(flights, dep_time <= 600) # Is this right?
```


## 5.3.1 Exercises
#### 1: How could you use arrange() to sort all missing values to the start? (Hint: use is.na()).
```{r}
arrange(flights, desc(is.na(dep_time))) %>% 
  tail()
```



#### 3: Sort flights to find the fastest (highest speed) flights.

```{r}
arrange(flights, desc(distance / air_time)) %>% 
  mutate(speed = distance/air_time) %>% 
  select(distance, air_time, speed) %>% 
  head()
```

## 5.4.1 Exercise
#### 4: Does the result of running the following code surprise you? How do the select helpers deal with case by default? How can you change that default?
```{r}
select(flights, contains("TIME"))
```

```{r}
select(flights, contains("TIME", ignore.case = FALSE))
```

## 5.5.2 Exercise
#### 5: What does 1:3 + 1:10 return? Why?

```{r}
1:3 + 1:10
```


## 5.6.7 Exercise
#### Which carrier has the worst delays? Challenge: can you disentangle the effects of bad airports vs. bad carriers? Why/why not? (Hint: think about flights %>% group_by(carrier, dest) %>% summarise(n()))


```{r}
# 1. Group by carrier

# 2. Summarise by mean of delay

# 3. Find the worst by arranging

arrange(flights, desc(is.na(arr_delay)))
```

```{r}
# 1. Group by carrier
carrier_groups <- group_by(flights, carrier)

# 2. Summarise by mean of delay
mean_summarise <- summarise(carrier_groups, mean_arr_delay = mean(arr_delay, na.rm = TRUE))

# 3. Find the worst by arranging
answer <- arrange(mean_summarise, desc(mean_arr_delay))

# 4. Show Answer
answer
```



```{r}
# With piping
answer <- flights %>%
  group_by(carrier) %>% # 1. Group by carrier
  summarise(mean_arr_delay2 = mean(arr_delay, na.rm = TRUE)) %>% # 2. Summarise by mean
  arrange(desc(mean_arr_delay2)) # Find the worst by arranging
# 4. Show answer
answer
```

